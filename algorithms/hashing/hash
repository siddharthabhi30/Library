How we ensure hash functions are randomized